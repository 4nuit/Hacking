## Script by Unknow101

import argparse
import requests
from colorama import Fore, Back, Style
from ipaddress import ip_address


def ips(start, end):
    '''Return IPs in IPv4 range, inclusive.'''
    start_int = int(ip_address(start).packed.hex(), 16)
    end_int = int(ip_address(end).packed.hex(), 16)
    return [ip_address(ip).exploded for ip in range(start_int, end_int)]


parser = argparse.ArgumentParser(
                    prog='Vulner',
                    description='What the program does',
                    epilog='Text at the bottom of help')
parser.add_argument("--ip", help="ip to be checked")
parser.add_argument("--range", help="range to be checked")
args = parser.parse_args()

if args.ip:
    host = requests.get("https://internetdb.shodan.io/"+args.ip).json()
    print(host)
elif args.range:
    ip_start = args.range.split("-")[0]
    ip_end = args.range.split("-")[1]
    all_ips = ips(ip_start,ip_end)
    for ip in all_ips:
        print(Fore.RED + Back.WHITE + ip + Style.RESET_ALL)
        host = requests.get("https://internetdb.shodan.io/"+ip).json()
        if 'ports' in host:
            print("\t- Open ports :")
            for port in host['ports']:
                print("\t\t" + str(port))
        else:
            print("No open ports")
        if 'vulns' in host:
            if host['vulns']:
                print(Fore.RED + "VULN :")
                print(host['vulns'])
